// Ù†Ø¸Ø§Ù… Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ù„Ù€ GarticPhone Mod
class GPModUI {
    constructor() {
        this.ui = null;
        this.currentTab = 'painter';
        this.init();
    }

    init() {
        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        this.createUI();
        this.setupEvents();
        this.loadSettings();
        
        console.log('[GPMod UI] Initialized');
    }

    createUI() {
        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
        this.ui = document.createElement('div');
        this.ui.className = 'gpmod-ui';
        this.ui.id = 'gpmod-ui';
        this.ui.innerHTML = `
            <div class="gpmod-header">
                <div class="gpmod-title">ğŸ¨ GP Mod</div>
                <button class="gpmod-close">âœ•</button>
            </div>
            
            <div class="gpmod-tabs">
                <button class="gpmod-tab active" data-tab="painter">Painter</button>
                <button class="gpmod-tab" data-tab="avatars">Avatars</button>
                <button class="gpmod-tab" data-tab="reference">Reference</button>
                <button class="gpmod-tab" data-tab="settings">Settings</button>
            </div>
            
            <div class="gpmod-content" id="gpmod-content">
                <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ÙŠØªØºÙŠØ± Ø­Ø³Ø¨ Ø§Ù„ØªØ¨ÙˆÙŠØ¨ -->
                <div id="painter-content">
                    <h3>ğŸ¨ Enhanced Painter</h3>
                    <div class="control-group">
                        <label>Brush Size: <span id="brush-size">5</span></label>
                        <input type="range" id="brush-slider" min="1" max="50" value="5">
                    </div>
                    <div class="shortcuts">
                        <h4>Keyboard Shortcuts:</h4>
                        <div class="shortcut-item"><kbd>Alt</kbd> Color Picker</div>
                        <div class="shortcut-item"><kbd>Ctrl</kbd> + Mouse: Brush Size</div>
                        <div class="shortcut-item"><kbd>Shift</kbd> + Mouse: Opacity</div>
                        <div class="shortcut-item"><kbd>V</kbd> + Mouse: Value</div>
                        <div class="shortcut-item"><kbd>Space</kbd> Hand Tool</div>
                        <div class="shortcut-item"><kbd>C</kbd> Eraser (Hold)</div>
                        <div class="shortcut-item"><kbd>F</kbd> Clear Canvas</div>
                    </div>
                </div>
                
                <div id="avatars-content" style="display:none;">
                    <h3>ğŸ‘¤ Avatar System</h3>
                    <div id="avatar-preview"></div>
                    <button id="avatar-upload">Upload Image</button>
                    <button id="avatar-send">Send for Review</button>
                    <button id="avatar-remove">Remove Avatar</button>
                    <div class="avatar-info">
                        <p>âš ï¸ Avatars require moderation</p>
                    </div>
                </div>
                
                <div id="reference-content" style="display:none;">
                    <h3>ğŸ” Reference Finder</h3>
                    <input type="text" id="ref-search" placeholder="Search images...">
                    <select id="ref-service">
                        <option value="google">Google Images</option>
                        <option value="pinterest">Pinterest</option>
                        <option value="unsplash">Unsplash</option>
                    </select>
                    <button id="ref-search-btn">Search</button>
                    <div id="ref-results"></div>
                </div>
                
                <div id="settings-content" style="display:none;">
                    <h3>âš™ï¸ Settings</h3>
                    <div class="setting">
                        <label><input type="checkbox" id="painter-enabled"> Enable Enhanced Painter</label>
                    </div>
                    <div class="setting">
                        <label><input type="checkbox" id="avatars-enabled"> Enable Avatar System</label>
                    </div>
                    <div class="setting">
                        <label><input type="checkbox" id="reference-enabled"> Enable Reference Finder</label>
                    </div>
                </div>
            </div>
        `;
        
        document.body.appendChild(this.ui);
    }

    setupEvents() {
        // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
        this.ui.querySelectorAll('.gpmod-tab').forEach(tab => {
            tab.addEventListener('click', (e) => {
                const tabName = e.target.dataset.tab;
                this.switchTab(tabName);
            });
        });
        
        // Ø²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
        this.ui.querySelector('.gpmod-close').addEventListener('click', () => {
            this.toggleUI();
        });
        
        // Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ù„ÙØªØ­/Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.shiftKey && e.key === 'M') {
                this.toggleUI();
            }
        });
    }

    switchTab(tabName) {
        this.currentTab = tabName;
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©
        this.ui.querySelectorAll('.gpmod-tab').forEach(tab => {
            tab.classList.toggle('active', tab.dataset.tab === tabName);
        });
        
        // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨
        ['painter', 'avatars', 'reference', 'settings'].forEach(tab => {
            const element = this.ui.querySelector(`#${tab}-content`);
            if (element) {
                element.style.display = tab === tabName ? 'block' : 'none';
            }
        });
    }

    toggleUI() {
        this.ui.style.display = this.ui.style.display === 'none' ? 'block' : 'none';
    }

    loadSettings() {
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
        const settings = JSON.parse(localStorage.getItem('gpmod-settings') || '{}');
        
        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        if (settings.painterEnabled !== undefined) {
            document.getElementById('painter-enabled').checked = settings.painterEnabled;
        }
    }

    saveSettings() {
        const settings = {
            painterEnabled: document.getElementById('painter-enabled').checked,
            avatarsEnabled: document.getElementById('avatars-enabled').checked,
            referenceEnabled: document.getElementById('reference-enabled').checked
        };
        
        localStorage.setItem('gpmod-settings', JSON.stringify(settings));
    }
}

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
let gpmodUI = null;
document.addEventListener('DOMContentLoaded', () => {
    setTimeout(() => {
        gpmodUI = new GPModUI();
    }, 2000);
});
